<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seatwarmr Tests</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }
        .test-pass {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .test-fail {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        .test-summary {
            margin-top: 30px;
            padding: 20px;
            background: #e9ecef;
            border-radius: 5px;
            font-weight: bold;
        }
        .pass { color: #28a745; }
        .fail { color: #dc3545; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸ§ª Seatwarmr Test Suite</h1>
        <div id="test-results"></div>
        <div id="test-summary" class="test-summary"></div>
    </div>

    <script src="../app.js"></script>
    <script>
        // Simple test framework
        class TestRunner {
            constructor() {
                this.tests = [];
                this.passed = 0;
                this.failed = 0;
            }

            test(name, fn) {
                this.tests.push({ name, fn });
            }

            async run() {
                const resultsDiv = document.getElementById('test-results');
                const summaryDiv = document.getElementById('test-summary');

                for (const test of this.tests) {
                    try {
                        await test.fn();
                        this.passed++;
                        resultsDiv.innerHTML += `
                            <div class="test-result test-pass">
                                âœ“ ${test.name}
                            </div>
                        `;
                    } catch (error) {
                        this.failed++;
                        resultsDiv.innerHTML += `
                            <div class="test-result test-fail">
                                âœ— ${test.name}<br>
                                <small>${error.message}</small>
                            </div>
                        `;
                    }
                }

                const total = this.passed + this.failed;
                const passRate = ((this.passed / total) * 100).toFixed(1);
                summaryDiv.innerHTML = `
                    <div>Total Tests: ${total}</div>
                    <div class="pass">Passed: ${this.passed}</div>
                    <div class="fail">Failed: ${this.failed}</div>
                    <div>Pass Rate: ${passRate}%</div>
                `;
            }
        }

        // Assertion helper
        function assert(condition, message) {
            if (!condition) {
                throw new Error(message || 'Assertion failed');
            }
        }

        function assertEqual(actual, expected, message) {
            if (actual !== expected) {
                throw new Error(message || `Expected ${expected}, got ${actual}`);
            }
        }

        // Mock DOM elements for testing
        function setupMockDOM() {
            if (!document.getElementById('card')) {
                const mockHTML = `
                    <div style="display:none;">
                        <div id="card"></div>
                        <div id="cardImage"></div>
                        <div id="cardName"></div>
                        <div id="cardAge"></div>
                        <div id="cardBio"></div>
                        <div id="likeIndicator"></div>
                        <div id="nopeIndicator"></div>
                        <div id="progressFill"></div>
                        <button id="likeBtn"></button>
                        <button id="nopeBtn"></button>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', mockHTML);
            }
        }

        // Run tests
        const runner = new TestRunner();

        // Test 1: Profile data exists and has 5 profiles
        runner.test('Should have exactly 5 profiles', () => {
            const profiles = window.profiles;
            assert(profiles, 'Profiles array should exist');
            assertEqual(profiles.length, 5, 'Should have exactly 5 profiles');
        });

        // Test 2: Each profile has required fields
        runner.test('Each profile should have required fields', () => {
            const profiles = window.profiles;
            profiles.forEach((profile, index) => {
                assert(profile.name, `Profile ${index} should have a name`);
                assert(profile.age, `Profile ${index} should have an age`);
                assert(profile.bio, `Profile ${index} should have a bio`);
                assert(profile.image, `Profile ${index} should have an image`);
            });
        });

        // Test 3: Initial profile index should be 0
        runner.test('Initial profile index should be 0', () => {
            // Test will verify the profile index tracking works
            assert(typeof getCurrentProfileIndex === 'function', 'getCurrentProfileIndex function should be exported');
        });

        // Test 4: Profile progression tracking
        runner.test('Should track profile progression correctly', () => {
            // Test the exported functions exist for progression tracking
            assert(typeof setCurrentProfileIndex === 'function', 'setCurrentProfileIndex function should be exported');
            assert(typeof getCurrentProfileIndex === 'function', 'getCurrentProfileIndex function should be exported');
        });

        // Test 5: Swipe logic should exist
        runner.test('Swipe logic should exist', () => {
            // Check if swipe function is available in the global scope from app.js
            assert(typeof swipe === 'function' || window.swipe, 'Swipe function should exist');
        });

        // Test 6: Profile loading function exists
        runner.test('Profile loading function should exist', () => {
            // Check if loadProfile function is available
            assert(typeof loadProfile === 'function' || window.loadProfile, 'loadProfile function should exist');
        });

        // Test 7: All profiles have unique names
        runner.test('All profiles should have unique names', () => {
            const profiles = window.profiles;
            const names = profiles.map(p => p.name);
            const uniqueNames = new Set(names);
            assertEqual(names.length, uniqueNames.size, 'All profile names should be unique');
        });

        // Test 8: Profile ages are valid numbers
        runner.test('Profile ages should be valid numbers', () => {
            const profiles = window.profiles;
            profiles.forEach((profile, index) => {
                assert(typeof profile.age === 'number', `Profile ${index} age should be a number`);
                assert(profile.age >= 18 && profile.age <= 100, `Profile ${index} age should be reasonable`);
            });
        });

        // Test 9: Profile images should be valid URLs
        runner.test('Profile images should be valid URLs', () => {
            const profiles = window.profiles;
            profiles.forEach((profile, index) => {
                assert(profile.image.startsWith('http'), `Profile ${index} image should be a valid URL`);
            });
        });

        // Test 10: Progression should complete after 5 swipes
        runner.test('Should complete after swiping through 5 profiles', () => {
            const profiles = window.profiles;
            const totalProfiles = profiles.length;
            assertEqual(totalProfiles, 5, 'Should have 5 profiles to complete the swiping phase');
        });

        // Run all tests
        setupMockDOM();
        runner.run();
    </script>
</body>
</html>

